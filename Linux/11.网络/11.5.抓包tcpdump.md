# 抓包 tcpdump
和 WireShark 一样，tcpdump 也是一款抓包软件，主要在 Unix/Linux 系统上使用  

## 基本使用
``` Shell
tcpdump -D              # 列出所有可以抓包的网卡
tcpdump -i 指定网卡     # 从指定网卡上抓包，如果只有一个网卡则无需指定
```

其它常用参数：  
* **-v** ：verbose 模式，显示更多信息  
* **-s数字**：tcpdump 默认只截取 96 B，可以以该参数截取指定字节，为 0 时表示截取全部，注意数字前无空格  
* **-n**：不解析域名，直接显示 IP  
* **-nn**：不解析域名和端口
* **-p**：默认下启用 tcpdump 会让网卡进入混杂模式，使用该参数则不会  
* **-e**：显示数据链路层信息  
* **-A**：使用 ASCII 解析内容  
* **-X**：同时使用 16 进制和 ASCII 解析内容，和 `-A` 不能同时使用  
* **-w 指定文件**：输出到指定文件  

---------------------
## 过滤
tcpdump 提供了众多过滤器，具体内容如下，使用方法和参数差不多：  
### 主机过滤
* **host 主机ip**：只捕获与指定主机交互的数据包  
* **src host 主机ip**：只捕获来源于某主机的数据包  

### 子网过滤
* **net 网络前缀**：只捕获来源某一子网的，只需要写到网络前缀的非 0 部分即可，如 10.128 表示捕获 10.128.0.0/16 的子网(也可以直接写 net 10.128.0.0/16)  
* **src net 网络前缀**：同 src host  

### 协议过滤
* **proto 协议**：支持 icmp, igmp, igrp, pim, ah, esp, carp, vrrp, udp和 tcp，其中 proto 关键字可以省略，不省略时协议名可能需要转义  

### 端口过滤
* **port 指定端口**：只捕获指定端口

