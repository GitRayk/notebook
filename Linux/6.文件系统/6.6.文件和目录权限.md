# 文件和目录权限

权限用于控制进程对系统中文件和目录的访问  

文件的三个级别：
**文件主、同组用户、其它用户**  

uid 和 gid 编号与名字的对应关系见 `/etc/passwd` 和 `/etc/group`  

**root 用户不受权限制约**  

**其中每个文件只有唯一的属主**  

-------------------
## 文件权限
普通文件的权限有三种：  
**读、写、执行**  
分别以 r w x 表示  

（不可写的文件不意味着不能删除）  

可执行文件中，可以分为**程序文件**和**脚本文件**   

### 脚本文件
脚本文件的默认执行程序通常为 /bin/sh 

脚本文件中的**第一行**也可以自行指定解释程序，并以 `#!` 为开头，后面跟程序路径  

--------------
## 目录权限
对于目录来说，若没有读权限，则目录下执行 `ls` 相关指令会出错  

若没有写权限，则不可以在目录中增、删、改名文件  
**但是可以修改文件里面的内容，因为这和目录文件无关**  

若没有执行权限，则在分析路径名时不可检索该目录  
如: `cat ../sondir`  
要求对 `..` 目录有 x 权限，对 `sondir` 文件有 r 权限  

----------------
## STICKY 权限
除了常见的 r w x 权限之外，还有**STICKY权限（粘着位）**  

在早期 Unix 中具有该属性的可执行文件会尽量常驻在内存或交换区中以提高效率  

但是现代 Linux 会自动缓冲，该属性就被忽略了  

但对于目录来说，STICKEY 用于实现这样一件事：  
**目录中的文件只有属主可以删除，即使其它用户有写权限**  

`ls -ld /tmp` 输出第一列的最后一个字符为 t ，即代表了它是 STICKY 目录  

---------------
## SUID 权限
**一个可执行程序可以为其设定 SUID 权限，当其它用户执行具有该权限的程序时，可以暂时使用文件主的权限去访问其它文件**  

该方法依赖于文件组编写的程序

----------------
## 权限验证
每个文件都有属主和属组(inode中)  
每个进程也都有属主和属组(PCB中)  

如果文件主和进程主相同，则是用“主权限”，后续不再比较  

如果文件主与进程主不同，比较文件组和进程组，相同则使用“组权限”，后续不再比较  

如果比较都失败，则使用“其它用户权限”  
